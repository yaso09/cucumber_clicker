<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SalatalÄ±k DoÄŸra</title>

<style>
*{box-sizing:border-box;user-select:none;font-family:system-ui,sans-serif}
body{margin:0;background:#0f0f0f;color:#fff}
#game{padding:10px;max-width:500px;margin:auto}
h1{text-align:center}

button{
  background:#2a2a2a;
  color:#fff;
  border:1px solid #333;
  padding:8px 12px;
  margin:4px;
  border-radius:6px;
}

.panel{background:#181818;padding:10px;border-radius:10px;margin-bottom:10px}
.row{display:flex;flex-wrap:wrap;gap:5px}

#cucumber{
  font-size:64px;
  text-align:center;
  cursor:pointer;
}

.drop{
  position:absolute;
  font-size:24px;
  animation:fall 0.6s linear forwards;
}
@keyframes fall{
  from{transform:translateY(0);opacity:1}
  to{transform:translateY(80px);opacity:0}
}

.card{
  background:#202020;
  padding:8px;
  border-radius:8px;
  margin-bottom:6px;
  border:1px solid #333;
}

.bar{
  background:#333;
  height:8px;
  border-radius:5px;
  overflow:hidden;
}
.bar>div{
  background:#4caf50;
  height:100%;
}

.inactive{opacity:.4}
</style>
</head>
<body>

<div id="game">
<h1>ğŸ¥’ SalatalÄ±k DoÄŸra</h1>

<div class="panel">
  ğŸ’° Para: <span id="money">0</span><br>
  ğŸ¥’ SalatalÄ±k: <span id="cuk">0</span><br>
  ğŸ¥« TurÅŸu: <span id="pickle">0</span>
</div>

<div class="panel">
  <div id="cucumber" onclick="cut()">ğŸ¥’</div>
</div>

<div class="panel">
  <button onclick="sell()">Pazarda Sat (10 ğŸ¥’ â†’ 5 ğŸ’°)</button>
  <button onclick="makePickle()">TurÅŸu Kur (10 ğŸ¥’)</button>
</div>

<div class="panel">
  <h3>ğŸ­ Fabrika</h3>
  <div id="factoryInfo"></div>
  <button onclick="toggleFactory()">AÃ§ / Kapat</button>
  <button onclick="repairFactory()">Tamir (20 ğŸ’°)</button>
  <button onclick="upgradeFactory()">GÃ¼ncelle</button>
</div>

<div class="panel">
  <h3>ğŸ‘µ Teyzeler</h3>
  <button onclick="buyAunt()">Teyze Al (150 ğŸ’°)</button>
  <div id="aunts"></div>
</div>

<div class="panel">
  <h3>ğŸ¥« TurÅŸular</h3>
  <div id="pickles"></div>
</div>
</div>

<audio id="click" src="/assets/sounds/click.mp3"></audio>

<script>
const state={
  money:0,
  cuk:0,
  pickles:[],
  factory:{on:true,hp:100,max:100,lvl:1,timer:0},
  aunts:[]
}

function play(){
  const a=document.getElementById("click")
  a.currentTime=0;a.play()
}

function cut(){
  play()
  state.cuk++
  const d=document.createElement("div")
  d.className="drop"
  d.style.left=Math.random()*300+"px"
  d.innerText="ğŸ¥’"
  document.body.appendChild(d)
  setTimeout(()=>d.remove(),600)
}

function sell(){
  if(state.cuk<10)return
  state.cuk-=10
  state.money+=5
}

function randomExpiry(){
  const now=Date.now()
  const days=Math.floor(Math.random()*7)+1
  return {exp:now+days*86400000}
}

function makePickle(){
  if(state.cuk<10)return
  state.cuk-=10
  state.pickles.push(randomExpiry())
}

function toggleFactory(){
  state.factory.on=!state.factory.on
}

function repairFactory(){
  if(state.money<20)return
  state.money-=20
  state.factory.hp=state.factory.max
}

function upgradeFactory(){
  const cost=state.factory.lvl*50
  if(state.money<cost)return
  state.money-=cost
  state.factory.lvl++
  state.factory.max+=20
}

function buyAunt(){
  if(state.money<150)return
  state.money-=150
  state.aunts.push({hp:100,max:100,lvl:1,timer:0})
}

function feedAunt(i){
  if(state.money<15)return
  state.money-=15
  state.aunts[i].hp=state.aunts[i].max
}

function upgradeAunt(i){
  const cost=state.aunts[i].lvl*40
  if(state.money<cost)return
  state.money-=cost
  state.aunts[i].lvl++
  state.aunts[i].max+=20
}

setInterval(()=>{
  // fabrika
  const f=state.factory
  if(f.on && f.hp>0){
    f.timer++
    if(f.timer>10-f.lvl && state.cuk>=5){
      state.cuk-=5
      state.pickles.push(randomExpiry())
      f.timer=0
    }
    f.hp-=0.2
  }

  // teyzeler
  state.aunts.forEach(a=>{
    if(a.hp<=0)return
    a.hp-=0.3
    a.timer++
    const need=Math.max(2,8-a.lvl)
    if(a.timer>=need && state.cuk>=10){
      state.cuk-=10
      state.pickles.push(randomExpiry())
      a.timer=0
    }
  })

  // bozulma
  const now=Date.now()
  state.pickles=state.pickles.filter(p=>p.exp>now)

  render()
},1000)

function render(){
  money.textContent=state.money
  cuk.textContent=state.cuk
  pickle.textContent=state.pickles.length

  factoryInfo.innerHTML=`
  Seviye ${state.factory.lvl}<br>
  Can:
  <div class="bar"><div style="width:${state.factory.hp/state.factory.max*100}%"></div></div>
  `

  aunts.innerHTML=""
  state.aunts.forEach((a,i)=>{
    aunts.innerHTML+=`
    <div class="card ${a.hp<=0?"inactive":""}">
      Teyze ${i+1} | Seviye ${a.lvl}<br>
      <div class="bar"><div style="width:${a.hp/a.max*100}%"></div></div>
      <button onclick="feedAunt(${i})">Doyur</button>
      <button onclick="upgradeAunt(${i})">GÃ¼ncelle</button>
    </div>`
  })

  pickles.innerHTML=""
  state.pickles.forEach(p=>{
    const left=(p.exp-Date.now())/(p.exp-(p.exp-86400000))*100
    pickles.innerHTML+=`
    <div class="card">
      SKT: ${new Date(p.exp).toLocaleDateString()}
      <div class="bar"><div style="width:${left}%"></div></div>
    </div>`
  })
}
render()
</script>
</body>
</html>
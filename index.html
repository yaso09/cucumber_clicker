<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SalatalÄ±k DoÄŸra</title>

<style>
*{box-sizing:border-box;user-select:none;font-family:system-ui,sans-serif}
body{margin:0;background:#0f0f0f;color:#fff}
#game{display:flex;flex-direction:column;height:100vh;padding:10px;gap:8px}
.panel{background:#181818;border:1px solid #2c2c2c;border-radius:10px;padding:10px}
button{
  background:#222;border:1px solid #333;color:#fff;
  padding:6px 10px;border-radius:6px;margin:2px
}
button:active{transform:scale(.96)}
h2{margin:0 0 6px 0;font-size:16px}

#cucumber{font-size:64px;text-align:center;cursor:pointer}

.bar{height:6px;background:#333;border-radius:4px;overflow:hidden}
.bar>div{height:100%;background:#4caf50}

.card{background:#202020;border:1px solid #333;border-radius:8px;padding:6px;margin-bottom:5px}
.inactive{opacity:.4}

.drop{
  position:absolute;font-size:24px;
  animation:fall .6s linear forwards
}
@keyframes fall{
  to{transform:translateY(80px);opacity:0}
}
</style>
</head>
<body>

<div id="game">

<div class="panel">
  ğŸ’° <span id="money">0</span> |
  ğŸ¥’ <span id="cuk">0</span> |
  ğŸ¥« <span id="pickle">0</span>
</div>

<div class="panel">
  <div id="cucumber" onclick="cut()">ğŸ¥’</div>
</div>

<div class="panel">
  <button onclick="sell()">ğŸ›’ Pazarda Sat (10 ğŸ¥’)</button>
  <button onclick="makePickle()">ğŸ¥« TurÅŸu Kur</button>
</div>

<div class="panel">
  <h2>ğŸ­ Fabrika</h2>
  <div id="factoryUI"></div>
  <button onclick="toggleFactory()">AÃ§ / Kapat</button>
  <button onclick="repairFactory()">Tamir</button>
  <button onclick="upgradeFactory()">GÃ¼ncelle</button>
</div>

<div class="panel">
  <h2>ğŸ‘µ Teyzeler</h2>
  <button onclick="buyAunt()">Teyze Al</button>
  <div id="aunts"></div>
</div>

<div class="panel">
  <h2>ğŸ¥« TurÅŸular</h2>
  <div id="pickles"></div>
</div>

</div>

<audio id="click" src="/assets/sounds/click.mp3"></audio>

<script>
const S={
  money:0,cuk:0,pickles:[],
  factory:{on:true,hp:100,max:100,lvl:1,t:0},
  aunts:[]
}

const click=()=>{const a=document.getElementById("click");a.currentTime=0;a.play()}

function cut(){
  click()
  S.cuk++
  const d=document.createElement("div")
  d.className="drop";d.innerText="ğŸ¥’"
  d.style.left=Math.random()*300+"px"
  document.body.appendChild(d)
  setTimeout(()=>d.remove(),600)
}

function sell(){if(S.cuk>=10){S.cuk-=10;S.money+=5}}
function rndExp(){
  const d=(Math.random()*7+1)|0
  return {exp:Date.now()+d*86400000}
}
function makePickle(){if(S.cuk>=10){S.cuk-=10;S.pickles.push(rndExp())}}

function toggleFactory(){S.factory.on=!S.factory.on}
function repairFactory(){
  if(S.money<20)return
  S.money-=20;S.factory.hp=S.factory.max
}
function upgradeFactory(){
  const c=S.factory.lvl*50
  if(S.money<c)return
  S.money-=c;S.factory.lvl++;S.factory.max+=20
}

function buyAunt(){
  if(S.money<150)return
  S.money-=150
  S.aunts.push({hp:100,max:100,lvl:1,t:0})
}
function feedAunt(i){
  if(S.money<15)return
  S.money-=15;S.aunts[i].hp=S.aunts[i].max
}
function upgradeAunt(i){
  const c=S.aunts[i].lvl*40
  if(S.money<c)return
  S.money-=c;S.aunts[i].lvl++;S.aunts[i].max+=20
}

setInterval(()=>{
  const f=S.factory
  if(f.on && f.hp>0){
    f.t++
    if(f.t>10-f.lvl && S.cuk>=5){
      S.cuk-=5;S.pickles.push(rndExp());f.t=0
    }
    f.hp-=.2
  }

  S.aunts.forEach(a=>{
    if(a.hp<=0)return
    a.hp-=.3;a.t++
    if(a.t>=Math.max(2,8-a.lvl) && S.cuk>=10){
      S.cuk-=10;S.pickles.push(rndExp());a.t=0
    }
  })

  const now=Date.now()
  S.pickles=S.pickles.filter(p=>p.exp>now)
  render()
},1000)

function render(){
  money.textContent=S.money
  cuk.textContent=S.cuk
  pickle.textContent=S.pickles.length

  factoryUI.innerHTML=`
  Seviye ${S.factory.lvl} | ${S.factory.on?"AÃ§Ä±k":"KapalÄ±"}
  <div class="bar"><div style="width:${S.factory.hp/S.factory.max*100}%"></div></div>
  `

  aunts.innerHTML=""
  S.aunts.forEach((a,i)=>{
    aunts.innerHTML+=`
    <div class="card ${a.hp<=0?"inactive":""}">
      Teyze ${i+1} | Lv ${a.lvl}
      <div class="bar"><div style="width:${a.hp/a.max*100}%"></div></div>
      <button onclick="feedAunt(${i})">Doyur</button>
      <button onclick="upgradeAunt(${i})">GÃ¼ncelle</button>
    </div>`
  })

  pickles.innerHTML=""
  S.pickles.forEach(p=>{
    const r=(p.exp-Date.now())/86400000*100
    pickles.innerHTML+=`
    <div class="card">
      SKT ${new Date(p.exp).toLocaleDateString()}
      <div class="bar"><div style="width:${r}%"></div></div>
    </div>`
  })
}
render()
</script>
</body>
</html>